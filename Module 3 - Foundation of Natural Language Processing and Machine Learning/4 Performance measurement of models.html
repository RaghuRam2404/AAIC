<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>4 Performance measurement of models</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
  body {
    padding: 2cm; 
  }
}
</style>

<style type="text/css">
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #a67f59;
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}
</style>

<style type="text/css">
pre.line-numbers {
	position: relative;
	padding-left: 3.8em;
	counter-reset: linenumber;
}

pre.line-numbers > code {
	position: relative;
}

.line-numbers .line-numbers-rows {
	position: absolute;
	pointer-events: none;
	top: 0;
	font-size: 100%;
	left: -3.8em;
	width: 3em; /* works for line-numbers below 1000 lines */
	letter-spacing: -1px;
	border-right: 1px solid #999;

	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;

}

	.line-numbers-rows > span {
		pointer-events: none;
		display: block;
		counter-increment: linenumber;
	}

		.line-numbers-rows > span:before {
			content: counter(linenumber);
			color: #999;
			display: block;
			padding-right: 0.8em;
			text-align: right;
		}
</style>


</head>

<body>

<h1 id="toc_0">Performance measurement of models</h1>

<h2 id="toc_1">For Classification</h2>

<h2 id="toc_2">Accuracy</h2>

<p>Accuracy = \(\frac{\#\ correctly\ classified\ points}{Total\ \#\ points}\)</p>

<p>\(0\leq value\leq1\), with \(0\) being bad and \(1\) being good. It is taken as percentages.</p>

<p><strong><u>Problems with accuracy:</u></strong><br>
1) With <strong>imbalanced dataset</strong> and not well trained model (which gives output of the large population), we&#39;ll get high accuracy, but it is not the case.</p>

<p>2) If 2 models returns the probability score (like below), they have both the same \(\hat{y}\) and we knnow that \(m_1\) is better than \(m_2\). But the accuracy measure can&#39;t say this conclusion. So, it can&#39;t process <strong>probability scores</strong>.</p>

<table>
<thead>
<tr>
<th>x</th>
<th>y</th>
<th>\(m_1\)</th>
<th>\(m_2\)</th>
<th>\(\hat{y_1}\)</th>
<th>\(\hat{y_2}\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>\(x_1\)</td>
<td>1</td>
<td>0.9</td>
<td>0.6</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>\(x_2\)</td>
<td>1</td>
<td>0.8</td>
<td>0.65</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>\(x_3\)</td>
<td>0</td>
<td>0.1</td>
<td>0.45</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>\(x_4\)</td>
<td>0</td>
<td>0.15</td>
<td>0.48</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<h2 id="toc_3">Confusion matrix</h2>

<p>Can&#39;t process <strong>probability scores</strong>.</p>

<table>
<thead>
<tr>
<th><strong>pred</strong> \(\downarrow\) \ <strong>actual</strong>\(\rightarrow\)</th>
<th>0</th>
<th>1</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>a (TN)</td>
<td>b (FN)</td>
</tr>
<tr>
<td>1</td>
<td>c (FP)</td>
<td>d (TP)</td>
</tr>
</tbody>
</table>

<p>\(a\) is the no of predictions we got for the actual class &#39;0&#39; how of the data we <strong>correctly</strong> classified as &#39;0&#39; (<strong>True Negatives (TN)</strong>)<br>
\(b\) is the no of predictions we got for the actual class &#39;1&#39; how of the data we <strong>incorrectly</strong> classified as &#39;0&#39; (<strong>False Negatives (FN)</strong>) (ie) wrongly predicted as <strong>negatives</strong><br>
\(c\) is the no of predictions we got for the actual class &#39;0&#39; how of the data we <strong>incorrectly</strong> classified as &#39;1&#39; (<strong>False Positives (FP)</strong>)<br>
\(d\) is the no of predictions we got for the actual class &#39;1&#39; how of the data we <strong>correctly</strong> classified as &#39;1&#39; (<strong>True Positives (TP)</strong>)</p>

<p>It can be extended to <strong>c-classes</strong></p>

<p>All the <strong>diagonal elements must have high values</strong> and others to be small values for a <strong>model to be a good one</strong>.</p>

<p>Total no of positives <strong>P</strong> = <strong>TP</strong> + <strong>FN</strong><br>
Total no of negatives <strong>N</strong> = <strong>TN</strong> + <strong>FP</strong></p>

<p>True positive Rate (TPR) = \(\frac{TP}{P}\) \(\longrightarrow\) probability that an actual positive will test positive<br>
True Negative Rate (TNR) = \(\frac{TN}{N}\) \(\longrightarrow\) probability that an actual negative will test negative<br>
False Positive Rate (FPR) = \(\frac{FP}{N}\)  \(\longrightarrow\) probability that a true negative will be missed by the test<br>
False Negative Rate (FNR) = \(\frac{FN}{P}\) \(\longrightarrow\) probability that a true positive will be missed by the test</p>

<p>Why they are important?</p>

<p>Let&#39;s take dataset with 900 \(-ve\) and 100 \(+ve\) points.</p>

<table>
<thead>
<tr>
<th><strong>pred</strong> \(\downarrow\) \ <strong>actual</strong>\(\rightarrow\)</th>
<th>0</th>
<th>1</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>850 (TN)</td>
<td>6 (FN)</td>
</tr>
<tr>
<td>1</td>
<td>50 (FP)</td>
<td>94 (TP)</td>
</tr>
</tbody>
</table>

<p>P = 100<br>
N = 900</p>

<p>TPR = 94% \(\uparrow\)<br>
TNR = 94.44% \(\uparrow\)<br>
FPR = 5.55% \(\downarrow\)<br>
FNR = 6/100 = 6% \(\downarrow\)<br>
So, with TPR &amp; TNR \(\uparrow\) and FNR &amp; FPR \(\downarrow\), the <strong>model is good</strong>.</p>

<h3 id="toc_4">With dumb model</h3>

<table>
<thead>
<tr>
<th><strong>pred</strong> \(\downarrow\) \ <strong>actual</strong>\(\rightarrow\)</th>
<th>0</th>
<th>1</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>900 (TN)</td>
<td>100 (FN)</td>
</tr>
<tr>
<td>1</td>
<td>0 (FP)</td>
<td>0 (TP)</td>
</tr>
</tbody>
</table>

<p>TPR  = 0%<br>
TNR = 100%<br>
FPR = 0%<br>
FNR = 100%</p>

<p>TPR is very small and so model is dumb.<br>
We can use this for <strong>imbalanced dataset</strong>.</p>

<h3 id="toc_5">Precision, Recall &amp; F1-score</h3>

<p>Precision, \(Pr=\frac{TP}{TP+FP}\)<br>
It states that <strong>Of all the points the model predicted to be positive, what percentage of data are originally posistive?</strong> It cares only about the positive class.</p>

<p>Recall, Re = \(\frac{TP}{P}\)<br>
It states that <strong>Of all the actual positive points, how many of those points are correctly predicted by the model?</strong> It cares only about the positive class.</p>

<p>We want <strong>precision</strong> and <strong>recall</strong> to be high. <strong>F1-score</strong> is based on both of them.</p>

<p><strong>F1-score</strong> = \(\frac{2}{(\frac{1}{pr}+\frac{1}{re})}\)= \(2*\frac{pr*re}{pr+re}\)</p>

<p>It is the harmonic mean.</p>

<p>F1-score is \(\uparrow\) if precision is \(\uparrow\) and recall is \(\uparrow\). Good way to measure the performance.</p>

<h2 id="toc_6">Receiver Operating Characteristic Curve (ROC) curve and AUC - for binary classification</h2>

<table>
<thead>
<tr>
<th>\(x\)</th>
<th>\(y\)</th>
<th>\(\hat{y}\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>\(x_1\)</td>
<td>1</td>
<td>0.95</td>
</tr>
<tr>
<td>\(x_2\)</td>
<td>1</td>
<td>0.92</td>
</tr>
<tr>
<td>\(x_3\)</td>
<td>0</td>
<td>0.80</td>
</tr>
<tr>
<td>\(x_4\)</td>
<td>1</td>
<td>0.76</td>
</tr>
<tr>
<td>\(x_5\)</td>
<td>1</td>
<td>0.71</td>
</tr>
</tbody>
</table>

<p>After sorting the \(\hat{y}\), we&#39;ll apply thresholding (\(\tau_1\))</p>

<p>Above that threshold, assign all the \(\tilde{y}_{\tau_1}\) as \(1\) (\(+ve\))</p>

<table>
<thead>
<tr>
<th>\(x\)</th>
<th>\(y\)</th>
<th>\(\hat{y}\)</th>
<th>\(\tilde{y}_{\tau_1}\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>\(x_1\)</td>
<td>1</td>
<td>0.95</td>
<td>1</td>
</tr>
<tr>
<td>\(x_2\)</td>
<td>1</td>
<td>0.92</td>
<td>0</td>
</tr>
<tr>
<td>\(x_3\)</td>
<td>0</td>
<td>0.80</td>
<td>0</td>
</tr>
<tr>
<td>\(x_4\)</td>
<td>1</td>
<td>0.76</td>
<td>0</td>
</tr>
<tr>
<td>\(x_5\)</td>
<td>1</td>
<td>0.71</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>calculate \(TPR_1\) &amp; \(FPR_1\) for this \(\tau_1\). Repeat the same for the next \(\hat{y}\) value 0.92 .</p>

<table>
<thead>
<tr>
<th>\(x\)</th>
<th>\(y\)</th>
<th>\(\hat{y}\)</th>
<th>\(\tilde{y}_{\tau_1}\)</th>
<th>\(\tilde{y}_{\tau_2}\)</th>
</tr>
</thead>

<tbody>
<tr>
<td>\(x_1\)</td>
<td>1</td>
<td>0.95</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>\(x_2\)</td>
<td>1</td>
<td>0.92</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>\(x_3\)</td>
<td>0</td>
<td>0.80</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>\(x_4\)</td>
<td>1</td>
<td>0.76</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>\(x_5\)</td>
<td>1</td>
<td>0.71</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>calculate \(TPR_2\) &amp; \(FPR_2\) for this \(\tau_2\)</p>

<p>Repeat this for all points.</p>

<p>Plot the graph with \(FPR\) in \(x-axis\) and \(TPR\) in \(y-axis\).</p>

<p><img src="./4%20Performance%20measurement%20of%20models/Screen%20Shot%202021-06-14%20at%208.00.05%20PM.png" alt=""></p>

<p><strong>Disadvantages:</strong><br>
1. Area under AUC doesn&#39;t work well for imbalanced data<br>
2. AUC is not dependent \(\hat{y}\) score instead they rely on the sorted values. So two models may result in the same order of the data.<br>
3. For a random binary model (i.e random class for a x), then ROC of the model is diagonal with AUC as 0.5<br>
4. AUC below 0.5 means, it is very worst model. Now, we can swap/switch the values of \(\hat{y}\) which will result in AUC greater than 0.5</p>

<h2 id="toc_7">Log-loss</h2>

<p>It uses the <strong>probability scores</strong>.</p>

<p>For Binary classification :</p>

<table>
<thead>
<tr>
<th>\(x\)</th>
<th>\(y\)</th>
<th>\(\hat{y}=p\)</th>
<th>log loss term</th>
</tr>
</thead>

<tbody>
<tr>
<td>\(x_1\)</td>
<td>1</td>
<td>0.9</td>
<td>0.0457</td>
</tr>
<tr>
<td>\(x_2\)</td>
<td>1</td>
<td>0.6</td>
<td>0.22</td>
</tr>
<tr>
<td>\(x_3\)</td>
<td>0</td>
<td>0.1</td>
<td>0.0457</td>
</tr>
<tr>
<td>\(x_4\)</td>
<td>0</td>
<td>0.4</td>
<td>0.22</td>
</tr>
</tbody>
</table>

<p>Given a test set of n points,</p>

<p>\(log\_loss=\frac{-1}{n}\sum_{i=1}^n(log(p_i)*y_i + log(1-p_i)*(1-y_i))\) with values ranges from \(0\ to\ \infty\)</p>

<p>If \(p_i\) close to 1, log loss term of that input is very low and vice versa. It penalizes for the small deviations in the probabilities.</p>

<p>We want log loss to be small. It is because of the below graph</p>

<p><img src="./4%20Performance%20measurement%20of%20models/Screen%20Shot%202021-06-14%20at%208.19.08%20PM.png" alt=""></p>

<h3 id="toc_8">For multiclass</h3>

<p>\(log\_loss=\frac{-1}{n}\sum_{i=1}^n\sum_{j=1}^clog(p_{ij})*y_{ij}\) where \(y_{ij} = 1\) if \(x_i\) is the class label \(c_j\) otherwise 0</p>

<h2 id="toc_9">For Regression</h2>

<p>Here \(y\ \epsilon\ R^d\)</p>

<h2 id="toc_10">R<sup>2</sup> or co-eff of determination</h2>

<p>\(e_i=y_i-\hat{y_i}\)<br>
\(|e_i|\)=0 (i.e) it is good. Greater the value of \(e_i\), it is bad.</p>

<p>having error as \(e_i\) is not meaningful as we did in binary classification.</p>

<p>Mean Squared error (MSE) = \(\frac{1}{n}\sum_{i=1}^ne_i^2\)</p>

<p>Sum of squares, \(SS_{total}=\sum_{i=1}^n(y_i-\bar{y})^2\) where \(\bar{y}\) is the mean of \(y\)</p>

<p>Residue error, \(SS_{res}=\sum_{i=1}^n(\hat{y_i}-\bar{y})^2\)</p>

<p>\(R^2=1-\frac{SS_{res}}{SS_{total}}\)</p>

<p><u>Case 1 :</u> When \(SS_{res}=0\), \(R^2=1\) .. Very good model<br>
<u>Case 2 :</u> When \(SS_{res}&lt;SS_{total}\), \(=\leq R^2\leq 1\) .. Closer to 1, model is better. closer to 0, model is bad.<br>
<u>Case 3 :</u> When \(SS_{res}=SS_{total}\), \(R^2=0\) Model is same as <strong>simple mean model</strong>. In the simple mean model, we&#39;ll predict for all values of \(x_i\) as \(y_i\) and return \(\bar{y}\) when queried for \(x_i\)<br>
<u>Case 4 :</u> When \(SS_{res}&gt;SS_{total}\), \(R^2 &lt; 0\). It means that the model is worse than the simple mean model.</p>

<p>Problem here is that, <strong>if we have outliers, it&#39;ll affect the \(SS_{res}\). It is not robust to outliers</strong>. So we can use MAD</p>

<h2 id="toc_11">Mean Absolute Percentage Error (MAPE)</h2>

<p>MAPE = \(\frac{1}{n} \sum_{i=1}^n|\frac{e_i}{y_i}|\)</p>

<p>What happens when \(y_i=0\), we can replace \(y_i\) with \(\bar{y}\)<br>
Modified MAPE = \(\frac{1}{n} \sum_{i=1}^n|\frac{e_i}{\bar{y}}|\) = \(\frac{\sum_{i=1}^n|e_i|}{\sum_{i=1}^ny_i}\) (after simplifying)</p>

<h2 id="toc_12">Median absolute deviation (MAD)</h2>

<p>For an \(x_i\), we have \(y_i\), \(\hat{y_i}\), \(e_i\).</p>

<p>Consider the random variable \(e_i\)<br>
Median(\(e_i\)) = central value of all errors<br>
MAD(\(e_i\)) = \(median(|e_i-median(e_i)|)\)</p>

<p><strong>MAD is small, means error is low</strong></p>

<h2 id="toc_13">Distribution of errors</h2>

<p>For an \(x_i\), we have \(y_i\), \(\hat{y_i}\), \(e_i\).</p>

<p>We can use PDF &amp; CDF of \(e_i\)&#39;s to see how the errors are distributed.</p>

<p><img src="./4%20Performance%20measurement%20of%20models/Screen%20Shot%202021-06-14%20at%208.46.55%20PM.png" alt=""></p>

<p>Few errors are large values, most of the errors are of small values \(\implies\) model is good</p>

<p>From CDF, 99% of all errors are less than 0.1.</p>

<h2 id="toc_14">Interview questions</h2>

<p>Which is more important to you– model accuracy, or model performance?</p>

<blockquote>
<p>model performance</p>
</blockquote>

<p>Can you cite some examples where a false positive is important than a false negative?</p>

<blockquote>
<p>Decision based on revenue prediction of a company, where if we predicted revenue is going to increase (FP) in near future however in actual it is not the decision company might have taken on prediction basis can impact company reputation</p>
</blockquote>

<p>Can you cite some examples where a false negative important than a false positive?</p>

<blockquote>
<p>Generally medical test of any serious disease where ensuring no patient is wrongly classified if they are suffering with serious disease.</p>
</blockquote>

<p>Can you cite some examples where both false positive and false negatives are equally important?</p>

<blockquote>
<p>when we&#39;re classifying flowers into, say, two classes - Versicolor and Virginica, so here whether Versicolor is wrongly classified as Virginica or vice-versa both are equally bad, hence equal importance is given to FP and FN.</p>
</blockquote>

<p>What is the most frequent metric to assess model accuracy for classification problems?</p>

<blockquote>
<p>ROC in case of binary classification else confusion matrix. If we have probabilities, we can make use of log loss</p>
</blockquote>

<p>Why is Area Under ROC Curve (AUROC) better than raw accuracy as an out-of- sample evaluation metric?</p>



<script type="text/javascript">
var _self="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},Prism=function(){var e=/\blang(?:uage)?-(\w+)\b/i,t=0,n=_self.Prism={util:{encode:function(e){return e instanceof a?new a(e.type,n.util.encode(e.content),e.alias):"Array"===n.util.type(e)?e.map(n.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e){var t=n.util.type(e);switch(t){case"Object":var a={};for(var r in e)e.hasOwnProperty(r)&&(a[r]=n.util.clone(e[r]));return a;case"Array":return e.map&&e.map(function(e){return n.util.clone(e)})}return e}},languages:{extend:function(e,t){var a=n.util.clone(n.languages[e]);for(var r in t)a[r]=t[r];return a},insertBefore:function(e,t,a,r){r=r||n.languages;var l=r[e];if(2==arguments.length){a=arguments[1];for(var i in a)a.hasOwnProperty(i)&&(l[i]=a[i]);return l}var o={};for(var s in l)if(l.hasOwnProperty(s)){if(s==t)for(var i in a)a.hasOwnProperty(i)&&(o[i]=a[i]);o[s]=l[s]}return n.languages.DFS(n.languages,function(t,n){n===r[e]&&t!=e&&(this[t]=o)}),r[e]=o},DFS:function(e,t,a,r){r=r||{};for(var l in e)e.hasOwnProperty(l)&&(t.call(e,l,e[l],a||l),"Object"!==n.util.type(e[l])||r[n.util.objId(e[l])]?"Array"!==n.util.type(e[l])||r[n.util.objId(e[l])]||(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,l,r)):(r[n.util.objId(e[l])]=!0,n.languages.DFS(e[l],t,null,r)))}},plugins:{},highlightAll:function(e,t){var a={callback:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",a);for(var r,l=a.elements||document.querySelectorAll(a.selector),i=0;r=l[i++];)n.highlightElement(r,e===!0,a.callback)},highlightElement:function(t,a,r){for(var l,i,o=t;o&&!e.test(o.className);)o=o.parentNode;o&&(l=(o.className.match(e)||[,""])[1],i=n.languages[l]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+l,o=t.parentNode,/pre/i.test(o.nodeName)&&(o.className=o.className.replace(e,"").replace(/\s+/g," ")+" language-"+l);var s=t.textContent,u={element:t,language:l,grammar:i,code:s};if(!s||!i)return n.hooks.run("complete",u),void 0;if(n.hooks.run("before-highlight",u),a&&_self.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u.highlightedCode=e.data,n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(u.element),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},c.postMessage(JSON.stringify({language:u.language,code:u.code,immediateClose:!0}))}else u.highlightedCode=n.highlight(u.code,u.grammar,u.language),n.hooks.run("before-insert",u),u.element.innerHTML=u.highlightedCode,r&&r.call(t),n.hooks.run("after-highlight",u),n.hooks.run("complete",u)},highlight:function(e,t,r){var l=n.tokenize(e,t);return a.stringify(n.util.encode(l),r)},tokenize:function(e,t){var a=n.Token,r=[e],l=t.rest;if(l){for(var i in l)t[i]=l[i];delete t.rest}e:for(var i in t)if(t.hasOwnProperty(i)&&t[i]){var o=t[i];o="Array"===n.util.type(o)?o:[o];for(var s=0;s<o.length;++s){var u=o[s],c=u.inside,g=!!u.lookbehind,h=!!u.greedy,f=0,d=u.alias;u=u.pattern||u;for(var p=0;p<r.length;p++){var m=r[p];if(r.length>e.length)break e;if(!(m instanceof a)){u.lastIndex=0;var y=u.exec(m),v=1;if(!y&&h&&p!=r.length-1){var b=r[p+1].matchedStr||r[p+1],k=m+b;if(p<r.length-2&&(k+=r[p+2].matchedStr||r[p+2]),u.lastIndex=0,y=u.exec(k),!y)continue;var w=y.index+(g?y[1].length:0);if(w>=m.length)continue;var _=y.index+y[0].length,P=m.length+b.length;if(v=3,P>=_){if(r[p+1].greedy)continue;v=2,k=k.slice(0,P)}m=k}if(y){g&&(f=y[1].length);var w=y.index+f,y=y[0].slice(f),_=w+y.length,S=m.slice(0,w),O=m.slice(_),j=[p,v];S&&j.push(S);var A=new a(i,c?n.tokenize(y,c):y,d,y,h);j.push(A),O&&j.push(O),Array.prototype.splice.apply(r,j)}}}}}return r},hooks:{all:{},add:function(e,t){var a=n.hooks.all;a[e]=a[e]||[],a[e].push(t)},run:function(e,t){var a=n.hooks.all[e];if(a&&a.length)for(var r,l=0;r=a[l++];)r(t)}}},a=n.Token=function(e,t,n,a,r){this.type=e,this.content=t,this.alias=n,this.matchedStr=a||null,this.greedy=!!r};if(a.stringify=function(e,t,r){if("string"==typeof e)return e;if("Array"===n.util.type(e))return e.map(function(n){return a.stringify(n,t,e)}).join("");var l={type:e.type,content:a.stringify(e.content,t,r),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:r};if("comment"==l.type&&(l.attributes.spellcheck="true"),e.alias){var i="Array"===n.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(l.classes,i)}n.hooks.run("wrap",l);var o="";for(var s in l.attributes)o+=(o?" ":"")+s+'="'+(l.attributes[s]||"")+'"';return"<"+l.tag+' class="'+l.classes.join(" ")+'" '+o+">"+l.content+"</"+l.tag+">"},!_self.document)return _self.addEventListener?(_self.addEventListener("message",function(e){var t=JSON.parse(e.data),a=t.language,r=t.code,l=t.immediateClose;_self.postMessage(n.highlight(r,n.languages[a],a)),l&&_self.close()},!1),_self.Prism):_self.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(n.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",n.highlightAll)),_self.Prism}();"undefined"!=typeof module&&module.exports&&(module.exports=Prism),"undefined"!=typeof global&&(global.Prism=Prism);
</script>

<script type="text/javascript">
!function(){"undefined"!=typeof self&&self.Prism&&self.document&&Prism.hooks.add("complete",function(e){if(e.code){var t=e.element.parentNode,s=/\s*\bline-numbers\b\s*/;if(t&&/pre/i.test(t.nodeName)&&(s.test(t.className)||s.test(e.element.className))&&!e.element.querySelector(".line-numbers-rows")){s.test(e.element.className)&&(e.element.className=e.element.className.replace(s,"")),s.test(t.className)||(t.className+=" line-numbers");var n,a=e.code.match(/\n(?!$)/g),l=a?a.length+1:1,m=new Array(l+1);m=m.join("<span></span>"),n=document.createElement("span"),n.className="line-numbers-rows",n.innerHTML=m,t.hasAttribute("data-start")&&(t.style.counterReset="linenumber "+(parseInt(t.getAttribute("data-start"),10)-1)),e.element.appendChild(n)}}})}();
</script>

<script type="text/x-mathjax-config">
(function () {

MathJax.Hub.Config({
	'showProcessingMessages': false,
	'messageStyle': 'none'
});

if (typeof MathJaxListener !== 'undefined') {
	MathJax.Hub.Register.StartupHook('End', function () {
		MathJaxListener.invokeCallbackForKey_('End');
	});
}

})();
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</body>

</html>
